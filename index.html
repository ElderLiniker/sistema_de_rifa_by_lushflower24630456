<html lang="pt-BR"><head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Sistema de Rifa</title>
  <link rel="stylesheet" href="./style.css">
</head>
<body>


  

  <div class="information" >
    <h2>RIFA DE CARNAVAL LAN√áADA
      CUIDA CUIDA</h2>
    <h2>
      PR√äMIO üèÜ 180,00 REAIS</h2>
    <p>1 DEZENA 3 REAIS</p>
    <p>2 DEZENA 5 REAIS</p>
    <p>4 DEZENA 10 REAIS</p>

    <h3>üçÄACREDITE, HOJE √â SEU DIA DE SORTE üçÄ
      <br><br>
      
      üÖøÔ∏è‚ÑπÔ∏è‚ùéüîë<br> <br>79999076889 <br><br>
      Banco Nubank <br><br>
      Sallano Vitor Da Hora Santos</h3>
  </div>

  <div id="reserva-form" style="display: none;">
    <h2>Reservar N√∫meros</h2>
    <label for="nome">Seu Nome:</label>
    <input type="text" id="nome" name="nome"><br><br>
    
    <label for="numeros">N√∫meros a reservar (separados por v√≠rgula):</label>
    <input type="text" id="numeros" name="numeros"><br><br>

    <button onclick="reservarNumeros()">Reservar</button>
    <button onclick="fecharFormulario()">Cancelar</button>
  </div>
  <div id="rifa-container">
    
    
    <div class="numero" data-numero="00">00</div><div class="numero" data-numero="01">01</div><div class="numero" data-numero="02">02</div><div class="numero" data-numero="03">03</div><div class="numero" data-numero="04">04</div><div class="numero" data-numero="05">05</div><div class="numero" data-numero="06">06</div><div class="numero" data-numero="07">07</div><div class="numero" data-numero="08">08</div><div class="numero" data-numero="09">09</div><div class="numero" data-numero="10">10</div><div class="numero" data-numero="11">11</div><div class="numero" data-numero="12">12</div><div class="numero" data-numero="13">13</div><div class="numero" data-numero="14">14</div><div class="numero" data-numero="15">15</div><div class="numero" data-numero="16">16</div><div class="numero" data-numero="17">17</div><div class="numero" data-numero="18">18</div><div class="numero" data-numero="19">19</div><div class="numero" data-numero="20">20</div><div class="numero" data-numero="21">21</div><div class="numero" data-numero="22">22</div><div class="numero" data-numero="23">23</div><div class="numero" data-numero="24">24</div><div class="numero" data-numero="25">25</div><div class="numero" data-numero="26">26</div><div class="numero" data-numero="27">27</div><div class="numero" data-numero="28">28</div><div class="numero" data-numero="29">29</div><div class="numero" data-numero="30">30</div><div class="numero" data-numero="31">31</div><div class="numero" data-numero="32">32</div><div class="numero" data-numero="33">33</div><div class="numero" data-numero="34">34</div><div class="numero" data-numero="35">35</div><div class="numero" data-numero="36">36</div><div class="numero" data-numero="37">37</div><div class="numero" data-numero="38">38</div><div class="numero" data-numero="39">39</div><div class="numero" data-numero="40">40</div><div class="numero" data-numero="41">41</div><div class="numero" data-numero="42">42</div><div class="numero" data-numero="43">43</div><div class="numero" data-numero="44">44</div><div class="numero" data-numero="45">45</div><div class="numero" data-numero="46">46</div><div class="numero" data-numero="47">47</div><div class="numero" data-numero="48">48</div><div class="numero" data-numero="49">49</div><div class="numero" data-numero="50">50</div><div class="numero" data-numero="51">51</div><div class="numero" data-numero="52">52</div><div class="numero" data-numero="53">53</div><div class="numero" data-numero="54">54</div><div class="numero" data-numero="55">55</div><div class="numero" data-numero="56">56</div><div class="numero" data-numero="57">57</div><div class="numero" data-numero="58">58</div><div class="numero" data-numero="59">59</div><div class="numero" data-numero="60">60</div><div class="numero" data-numero="61">61</div><div class="numero" data-numero="62">62</div><div class="numero" data-numero="63">63</div><div class="numero" data-numero="64">64</div><div class="numero" data-numero="65">65</div><div class="numero" data-numero="66">66</div><div class="numero" data-numero="67">67</div><div class="numero" data-numero="68">68</div><div class="numero" data-numero="69">69</div><div class="numero" data-numero="70">70</div><div class="numero" data-numero="71">71</div><div class="numero" data-numero="72">72</div><div class="numero" data-numero="73">73</div><div class="numero" data-numero="74">74</div><div class="numero" data-numero="75">75</div><div class="numero" data-numero="76">76</div><div class="numero" data-numero="77">77</div><div class="numero" data-numero="78">78</div><div class="numero" data-numero="79">79</div><div class="numero" data-numero="80">80</div><div class="numero" data-numero="81">81</div><div class="numero" data-numero="82">82</div><div class="numero" data-numero="83">83</div><div class="numero" data-numero="84">84</div><div class="numero" data-numero="85">85</div><div class="numero" data-numero="86">86</div><div class="numero" data-numero="87">87</div><div class="numero" data-numero="88">88</div><div class="numero" data-numero="89">89</div><div class="numero" data-numero="90">90</div><div class="numero" data-numero="91">91</div><div class="numero" data-numero="92">92</div><div class="numero" data-numero="93">93</div><div class="numero" data-numero="94">94</div><div class="numero" data-numero="95">95</div><div class="numero" data-numero="96">96</div><div class="numero" data-numero="97">97</div><div class="numero" data-numero="98">98</div><div class="numero" data-numero="99">99</div></div>

  

  <!-- √Årea de administra√ß√£o -->
  <button class="admin01" onclick="mostrarLoginAdmin()">√Årea de Administra√ß√£o</button>

  <div id="admin-login" style="display: none;">
    <h2>Login Administrativo</h2>
    <label for="senha-admin">Senha:</label>
    <input type="password" id="senha-admin"><br><br>
    <button onclick="fazerLoginAdmin()">Entrar</button>
  </div>

  <div id="admin-area" style="display: none;">
    <h2>√Årea Administrativa</h2>
    <button onclick="sairAdmin()">Sair da √Årea Admin</button>
    <button onclick="limparRifa()">Limpar Rifa</button>
    <h3>N√∫meros Reservados</h3>
    <table id="tabela-reservas">
      <!-- Tabela de reservas ser√° gerada aqui -->
    </table>
    <style>/* Definindo a fonte global */
      /* Definindo a fonte global */
body {
  font-family: 'Roboto', sans-serif;  /* Fonte mais moderna e limpa */
  text-align: center;
  background-color: #2c2f3f;  /* Cor de fundo mais escura e s√≥bria */
  margin: 0;
  padding: 0;
  width: 100vw;
  height: 100vh;
  animation: fadeIn 1s ease-out;  /* Anima√ß√£o suave de fade-in para a p√°gina */
}

/* Anima√ß√£o de fade-in */
@keyframes fadeIn {
  0% {
    opacity: 0;
  }
  100% {
    opacity: 1;
  }
}

/* Estilo do logo */
.div-logo {
  padding: 20px;
  display: flex;
  justify-content: center;
  animation: slideUp 1s ease-out;  /* Anima√ß√£o de slide-up para o logo */
}

.div-logo img {
  width: 100%;
  max-width: 450px;
  height: auto;
  border-radius: 15px;
}

/* Anima√ß√£o de slide-up para a logo */
@keyframes slideUp {
  0% {
    transform: translateY(50px);
    opacity: 0;
  }
  100% {
    transform: translateY(0);
    opacity: 1;
  }
}

/* T√≠tulos principais */
h3 {
  padding: 20px;
  color: #fff;
  font-size: 24px;
  font-weight: 700;
  animation: fadeIn 1.2s ease-out;
}

/* Estilos de informa√ß√µes */
.information {
  margin: 20px;
  padding: 20px;
  border-radius: 15px;
  width: 95%;
  background-color: #1d2140;  /* Cor mais escura para o fundo */
  color: #f5f5f5;
  display: flex;
  justify-content: center;
  align-items: center;
  flex-direction: column;
  animation: fadeIn 1.2s ease-out;
}

/* Estilo do cont√™iner da rifa */
#rifa-container {
  display: grid;
  grid-template-columns: repeat(auto-fill, minmax(150px, 1fr));  /* Tamanho das colunas ajustado */
  gap: 15px;
  margin-top: 30px;
  animation: fadeIn 1.4s ease-out;
}

/* Estilo para cada n√∫mero */
.numero {
  padding: 20px;
  text-align: center;
  background-color: #f4f4f4;
  border-radius: 10px;
  border: 2px solid #ddd;
  font-size: 18px;
  color: #333;
  font-weight: 600;
  cursor: pointer;
  transition: transform 0.3s ease, background-color 0.3s ease, box-shadow 0.3s ease;
}

/* Efeito de hover para os n√∫meros */
.numero:hover {
  background-color: #5c6bc0;  /* Cor de fundo suave ao passar o mouse */
  color: #fff;
  transform: scale(1.05);  /* Leve aumento no tamanho */
  box-shadow: 0 4px 15px rgba(0, 0, 0, 0.2);  /* Sombras para criar profundidade */
}

/* N√∫meros reservados */
.numero.reservado {
  background-color: #b0bec5;
  color: #fff;
  cursor: not-allowed;
  box-shadow: none;
}

/* N√∫meros pagos */
.numero.pago {
  background-color: #81c784;
  color: #fff;
  cursor: not-allowed;
  box-shadow: none;
}

/* Estilo dos bot√µes */
.admin01,
button {
  padding: 15px;
  font-weight: bold;
  border-radius: 25px;
  font-size: 16px;
  cursor: pointer;
  background-color: #3f51b5;
  color: #fff;
  transition: background-color 0.3s ease, transform 0.3s ease;
  width: 90%;
  max-width: 250px;
  margin-top: 30px;
  border: none;
}

.admin01:hover,
button:hover {
  background-color: #303f9f;
  transform: translateY(-2px);  /* Efeito de eleva√ß√£o no hover */
}

/* Estilo dos campos de input */
input {
  padding: 15px;
  border-radius: 25px;
  width: 90%;
  max-width: 400px;
  margin-bottom: 20px;
  font-size: 18px;
  border: 2px solid #ddd;
  transition: border-color 0.3s ease, box-shadow 0.3s ease;
}

input:focus {
  border-color: #3f51b5;
  box-shadow: 0 0 10px rgba(63, 81, 181, 0.4);
}

/* Formul√°rios */
#reserva-form,
#admin-login,
#admin-area {
  border-radius: 20px;
  padding: 30px;
  background: #fff;
  max-width: 90%;
  margin: 20px auto;
  text-align: center;
  font-size: 18px;
  box-shadow: 0 4px 20px rgba(0, 0, 0, 0.1);
  animation: fadeIn 1.4s ease-out;
}

/* Tabela na √°rea de admin */
#admin-area table {
  width: 100%;
  border-collapse: collapse;
  margin-top: 20px;
}

#admin-area th,
#admin-area td {
  border: 1px solid #ddd;
  padding: 10px;
  text-align: left;
}

#admin-area th {
  background-color: #f5f5f5;
}

table {
  font-weight: bolder;
  font-size: 16px;
  border-radius: 10px;
  width: 100%;
  box-shadow: 0 4px 15px rgba(0, 0, 0, 0.1);
}

/* Estilos para dispositivos m√≥veis */
@media (max-width: 768px) {
  #rifa-container {
    grid-template-columns: repeat(auto-fill, minmax(120px, 1fr));
  }

  .information {
    width: 90%;
  }

  .numero {
    font-size: 16px;
    padding: 12px;
  }

  .admin01,
  button {
    font-size: 14px;
    padding: 12px;
  }

  input {
    font-size: 16px;
  }

  #reserva-form,
  #admin-login,
  #admin-area {
    font-size: 16px;
  }
}

      
      </style>
  <script >
    document.addEventListener('DOMContentLoaded', async function () {
  await carregarReservas();
  gerarRifa();
});

const apiUrl = 'https://rifa-api-spxw.onrender.com'; // Definindo a URL da API p√∫blica

async function carregarReservas() {
  try {
    const response = await fetch(`${apiUrl}/reservas`);
    const data = await response.json();
    numerosReservados = {};
    data.forEach(reserva => {
      numerosReservados[reserva.numero] = { nome: reserva.nome, pago: reserva.pago };
    });
    atualizarRifaContainer();
  } catch (error) {
    console.error('Erro ao carregar reservas:', error);
  }
}

let numerosReservados = {};
let numerosSelecionados = [];
let adminLogado = false;

function gerarRifa() {
  const rifaContainer = document.getElementById('rifa-container');
  rifaContainer.innerHTML = '';
  for (let i = 0; i < 100; i++) {
    const numeroDiv = document.createElement('div');
    numeroDiv.classList.add('numero');
    numeroDiv.dataset.numero = i.toString().padStart(2, '0');
    numeroDiv.textContent = i.toString().padStart(2, '0');

    // Exibe o nome da pessoa ao lado do n√∫mero
    if (numerosReservados[i.toString().padStart(2, '0')]) {
      const nomePessoa = numerosReservados[i.toString().padStart(2, '0')].nome;
      numeroDiv.textContent += ` - ${nomePessoa}`;
    }

    // Verifica se o n√∫mero foi reservado e marca a cor
    if (numerosReservados[i.toString().padStart(2, '0')]) {
      numeroDiv.classList.add('reservado');
      if (numerosReservados[i.toString().padStart(2, '0')].pago) {
        numeroDiv.classList.add('pago');
      }
    }

    numeroDiv.addEventListener('click', function() {
      selecionarNumero(i.toString().padStart(2, '0'));
    });
    rifaContainer.appendChild(numeroDiv);
  }
  atualizarRifaContainer();
}

function selecionarNumero(numero) {
  if (numerosReservados[numero] && !numerosReservados[numero].pago) {
    alert('Este n√∫mero j√° est√° reservado.');
    return;
  }

  if (numerosSelecionados.includes(numero)) {
    numerosSelecionados = numerosSelecionados.filter(num => num !== numero);
    const numeroDiv = document.querySelector(`.numero[data-numero="${numero}"]`);
    if (numeroDiv) {
      numeroDiv.classList.remove('selecionado');
    }
  } else {
    numerosSelecionados.push(numero);
    const numeroDiv = document.querySelector(`.numero[data-numero="${numero}"]`);
    if (numeroDiv) {
      numeroDiv.classList.add('selecionado');
    }
  }

  document.getElementById('numeros').value = numerosSelecionados.join(', ');
  document.getElementById('reserva-form').style.display = 'block';
}

async function reservarNumeros() {
  const nome = document.getElementById('nome').value;
  let numeros = document.getElementById('numeros').value.split(',').map(num => num.trim());

  if (!nome) {
    alert('Por favor, insira seu nome.');
    return;
  }

  try {
    const response = await fetch(`${apiUrl}/reservas`, {
      method: 'POST',
      headers: { 'Content-Type': 'application/json' },
      body: JSON.stringify({ numeros, nome }),
    });

    if (response.ok) {
      alert('Reserva feita com sucesso!');
      await carregarReservas();
    } else {
      alert('Erro ao reservar n√∫meros.');
    }
  } catch (error) {
    console.error('Erro ao reservar n√∫meros:', error);
  }
}

function fecharFormulario() {
  document.getElementById('reserva-form').style.display = 'none';
  numerosSelecionados = [];
  const elementosSelecionados = document.querySelectorAll('.numero.selecionado');
  elementosSelecionados.forEach(elemento => {
    elemento.classList.remove('selecionado');
  });
}

function mostrarLoginAdmin() {
  document.getElementById('admin-login').style.display = 'block';
}

function fazerLoginAdmin() {
  const senha = document.getElementById('senha-admin').value;

  // Verificar a senha atrav√©s de uma requisi√ß√£o de API
  fetch(`${apiUrl}/admin/login`, {
    method: 'POST',
    headers: { 'Content-Type': 'application/json' },
    body: JSON.stringify({ senha }),
  })
  .then(response => response.json())
  .then(data => {
    if (data.sucesso) {
      adminLogado = true;
      document.getElementById('admin-login').style.display = 'none';
      document.getElementById('admin-area').style.display = 'block';
      atualizarAreaAdmin();
      salvarDados();
    } else {
      alert('Senha incorreta.');
    }
  })
  .catch(error => {
    console.error('Erro ao fazer login:', error);
  });
}

function sairAdmin() {
  adminLogado = false;
  document.getElementById('admin-area').style.display = 'none';
  salvarDados();
}

async function limparRifa() {
  if (confirm('Tem certeza que deseja limpar toda a rifa?')) {
    try {
      const response = await fetch(`${apiUrl}/reservas`, { method: 'DELETE' });
      if (response.ok) {
        numerosReservados = {}; // Limpar os n√∫meros reservados no frontend
        gerarRifa(); // Regerar a rifa
        atualizarAreaAdmin(); // Atualizar a √°rea administrativa
        atualizarRifaContainer(); // Atualizar a interface de n√∫meros
        alert('Rifa limpa com sucesso!');
      } else {
        alert('Erro ao limpar a rifa.');
      }
    } catch (error) {
      console.error('Erro ao limpar a rifa:', error);
    }
  }
}


async function marcarComoPago(numero) {
  try {
    const response = await fetch(`${apiUrl}/reservas/${numero}/pago`, { method: 'PUT' });
    if (response.ok) {
      // Atualiza a interface para refletir que o n√∫mero foi marcado como pago
      const numeroDiv = document.querySelector(`.numero[data-numero="${numero}"]`);
      if (numeroDiv) {
        numeroDiv.classList.add('pago');
        numeroDiv.classList.remove('reservado');
      }
    }
  } catch (error) {
    console.error('Erro ao marcar como pago:', error);
  }
}
async function marcarComoNaoPago(numero) {
  try {
    const response = await fetch(`${apiUrl}/reservas/${numero}/nao-pago`, { method: 'PUT' });

    if (response.ok) {
      // Atualiza a interface para refletir que o n√∫mero foi marcado como n√£o pago
      const numeroDiv = document.querySelector(`.numero[data-numero="${numero}"]`);
      if (numeroDiv) {
        numeroDiv.classList.remove('pago');  // Remove a classe "pago"
        numeroDiv.classList.add('reservado'); // Adiciona a classe "reservado"
      }
    } else {
      alert('Erro ao marcar como n√£o pago');
    }
  } catch (error) {
    console.error('Erro ao marcar como n√£o pago:', error);
  }
}



async function excluirNumero(numero) {
  try {
    await fetch(`${apiUrl}/reservas/${numero}`, { method: 'DELETE' });
    await carregarReservas();
  } catch (error) {
    console.error('Erro ao excluir n√∫mero:', error);
  }
}

function atualizarAreaAdmin() {
  const tabelaReservas = document.getElementById('tabela-reservas');
  tabelaReservas.innerHTML = '';
  
  let cabecalho = tabelaReservas.createTHead();
  let linhaCabecalho = cabecalho.insertRow();
  let thNumero = document.createElement('th');
  let thNome = document.createElement('th');
  let thPago = document.createElement('th');
  let thAcoes = document.createElement('th');
  
  thNumero.textContent = 'N√∫mero';
  thNome.textContent = 'Nome';
  thPago.textContent = 'Pago';
  thAcoes.textContent = 'A√ß√µes';
  
  linhaCabecalho.appendChild(thNumero);
  linhaCabecalho.appendChild(thNome);
  linhaCabecalho.appendChild(thPago);
  linhaCabecalho.appendChild(thAcoes);

  for (const numero in numerosReservados) {
    if (numerosReservados.hasOwnProperty(numero)) {
      const reserva = numerosReservados[numero];
      let linha = tabelaReservas.insertRow();
      let celulaNumero = linha.insertCell();
      let celulaNome = linha.insertCell();
      let celulaPago = linha.insertCell();
      let celulaAcoes = linha.insertCell();

      celulaNumero.textContent = numero;
      celulaNome.textContent = reserva.nome;

      const btnPago = document.createElement('button');
      btnPago.textContent = reserva.pago ? 'Marcar como N√£o Pago' : 'Marcar como Pago';
      btnPago.style.backgroundColor = reserva.pago ? 'green' : ''; // Muda a cor para verde
      btnPago.addEventListener('click', function() {
        if (reserva.pago) {
          marcarComoNaoPago(numero);  // Marca como n√£o pago
        } else {
          marcarComoPago(numero);  // Marca como pago
        }
      });
      celulaPago.appendChild(btnPago);

      const btnExcluir = document.createElement('button');
      btnExcluir.textContent = 'Excluir';
      btnExcluir.addEventListener('click', function() {
        excluirNumero(numero);
      });
      celulaAcoes.appendChild(btnExcluir);
    }
  }
}


function atualizarNumeroDiv(numero) {
  const numeroDiv = document.querySelector(`.numero[data-numero="${numero}"]`);
  if (numeroDiv) {
    numeroDiv.classList.remove('reservado');
    numeroDiv.classList.remove('selecionado');
    numeroDiv.classList.remove('pago');
    numeroDiv.innerHTML = numero;

    if (numerosReservados[numero]) {
      numeroDiv.classList.add('reservado');
      if (numerosReservados[numero].pago) {
        numeroDiv.classList.add('pago');
      } else {
        numeroDiv.style.backgroundColor = '#f0ad4e'; // Cor para n√∫mero reservado, mas n√£o pago
      }
    }

    numeroDiv.removeEventListener('click', function() {}); 
    if (!numerosReservados[numero]) {
      numeroDiv.addEventListener('click', function() {
        selecionarNumero(numero);
      });
    }
  }
}

function salvarDados() {
  if (adminLogado) {
    localStorage.setItem('adminLogado', 'true');
  } else {
    localStorage.removeItem('adminLogado');
  }
}

  </script>

</body></html>